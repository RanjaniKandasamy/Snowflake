-- select role and warehouse
use role accountadmin;
use warehouse compute_wh;

-- use database and schema
create or replace database ttips;
create or replace schema ch01;

-- create a customer table under ttips.ch01
-- it is a transient table which contains 15 fields and datatypes
-- like varchar, number, decimal, boolean, date and timestamp

create or replace transient table customer_tsv(
customer_pk integer,
salutation varchar(10),
first_name varchar(20),
last_name varchar(30),
gender varchar(1),
marital_status varchar(1),
day_of_birth date,
birth_country varchar(60),
email_address varchar(50),
city_name varchar(60),
zip_code varchar(10),
country_name varchar(20),
gmt_timezone_offset number(10,2),
preferred_cust_flag boolean,
registration_time timestamp_ltz(9)
);

-- create a file format to parse the flat file data
-- type is csv, compression is none, field_delimiter is comma, skipping header

create or replace file format customer_tsv_ff
 type = 'csv'
 compression = 'none'
 field_delimiter = '\t'
 field_optionally_enclosed_by = '\042'
 skip_header = 1 ;

 -- Try to load data from the tsv file to Snowflake using Load Data button
 -- use Show SQL button to know whether the file will be purged after loading or not
 -- change on_error field to continue 

 
